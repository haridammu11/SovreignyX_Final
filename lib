import 'dart:io';
import 'package:lms_app/services/grok_service.dart';
import 'package:lms_app/utils/constants.dart';

void main() async {
  print('=== Grok Service Test ===');

  // Test with the API key from constants
  final apiKey = AppConstants.grokApiKey;
  print('Using API key: ${apiKey.substring(0, 10)}...');

  if (apiKey == 'YOUR_GROK_API_KEY_HERE' || apiKey.isEmpty) {
    print(
      'ERROR: Please configure your Grok API key in lib/utils/constants.dart',
    );
    exit(1);
  }

  try {
    final aiService = GrokService(apiKey: apiKey);

    print('\n--- Test 1: Simple message ---');
    final response1 = await aiService.sendMessage('Hello, what is 2+2?');
    print('Response: $response1');

    print('\n--- Test 2: Message with history ---');
    final history = [
      {'role': 'user', 'content': 'What is the capital of France?'},
      {'role': 'assistant', 'content': 'The capital of France is Paris.'},
    ];

    final response2 = await aiService.sendMessage(
      'What country is Paris in?',
      history: history,
    );
    print('Response: $response2');

    print('\n=== All tests completed successfully ===');
  } catch (e, stackTrace) {
    print('ERROR: $e');
    print('Stack trace: $stackTrace');
    exit(1);
  }
}
